# Generated by Django 5.2.11 on 2026-02-13 16:06

import django.db.models.deletion
import simple_history.models
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('chat', '0003_alter_cannedresponse_options_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='HistoricalCannedResponse',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('title', models.CharField(max_length=100)),
                ('shortcut', models.CharField(help_text='Trigger shortcut, e.g., /greeting', max_length=50)),
                ('content', models.TextField()),
                ('category', models.CharField(choices=[('order', 'Order Inquiry'), ('product', 'Product Question'), ('shipping', 'Shipping & Delivery'), ('returns', 'Returns & Refunds'), ('payment', 'Payment Issue'), ('technical', 'Technical Support'), ('general', 'General Inquiry'), ('complaint', 'Complaint'), ('feedback', 'Feedback')], default='general', max_length=20)),
                ('tags', models.JSONField(default=list)),
                ('is_global', models.BooleanField(default=False)),
                ('use_count', models.PositiveIntegerField(default=0)),
                ('last_used_at', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('agent', models.ForeignKey(blank=True, db_constraint=False, help_text='Null = shared across all agents', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.chatagent')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical canned response',
                'verbose_name_plural': 'historical canned responses',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalChatAgent',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('is_online', models.BooleanField(db_index=True, default=False)),
                ('is_accepting_chats', models.BooleanField(default=True)),
                ('last_active_at', models.DateTimeField(blank=True, null=True)),
                ('max_concurrent_chats', models.PositiveIntegerField(default=5)),
                ('current_chat_count', models.PositiveIntegerField(default=0)),
                ('categories', models.JSONField(default=list, help_text='List of category codes this agent can handle')),
                ('languages', models.JSONField(default=list, help_text='Languages the agent can support')),
                ('bio', models.TextField(blank=True)),
                ('skills', models.JSONField(default=list)),
                ('total_chats_handled', models.PositiveIntegerField(default=0)),
                ('avg_response_time_seconds', models.FloatField(default=0)),
                ('avg_rating', models.DecimalField(decimal_places=2, default=0, max_digits=3)),
                ('avatar', models.TextField(blank=True, help_text='Profile picture for the chat agent', max_length=100, null=True)),
                ('auto_accept', models.BooleanField(default=False)),
                ('notification_sound', models.BooleanField(default=True)),
                ('desktop_notifications', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Chat Agent',
                'verbose_name_plural': 'historical Chat Agents',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalChatAnalytics',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('date', models.DateField(db_index=True)),
                ('total_conversations', models.PositiveIntegerField(default=0)),
                ('new_conversations', models.PositiveIntegerField(default=0)),
                ('resolved_conversations', models.PositiveIntegerField(default=0)),
                ('total_messages', models.PositiveIntegerField(default=0)),
                ('customer_messages', models.PositiveIntegerField(default=0)),
                ('agent_messages', models.PositiveIntegerField(default=0)),
                ('bot_messages', models.PositiveIntegerField(default=0)),
                ('avg_first_response_seconds', models.FloatField(default=0)),
                ('avg_resolution_time_seconds', models.FloatField(default=0)),
                ('avg_rating', models.DecimalField(decimal_places=2, default=0, max_digits=3)),
                ('category_breakdown', models.JSONField(default=dict)),
                ('channel_breakdown', models.JSONField(default=dict)),
                ('hourly_breakdown', models.JSONField(default=dict)),
                ('agent_performance', models.JSONField(default=dict)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Chat Analytics',
                'verbose_name_plural': 'historical Chat Analytics',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalChatSettings',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('is_chat_enabled', models.BooleanField(default=True)),
                ('offline_message', models.TextField(default='We are currently offline. Please leave a message and we will get back to you.')),
                ('business_hours_enabled', models.BooleanField(default=False)),
                ('business_hours', models.JSONField(default=dict, help_text='{"monday": {"start": "09:00", "end": "18:00"}, ...}')),
                ('timezone', models.CharField(default='Asia/Dhaka', max_length=50)),
                ('welcome_message', models.TextField(default='Hello! How can we help you today?')),
                ('wait_message', models.TextField(default='Thanks for reaching out. An agent will be with you shortly.')),
                ('bot_name', models.CharField(default='Bunoraa Assistant', max_length=50)),
                ('bot_avatar', models.TextField(blank=True, max_length=100, null=True)),
                ('ai_enabled', models.BooleanField(default=True)),
                ('ai_model', models.CharField(default='gpt-4', max_length=50)),
                ('ai_temperature', models.FloatField(default=0.7)),
                ('ai_max_tokens', models.PositiveIntegerField(default=500)),
                ('ai_system_prompt', models.TextField(default='You are a helpful customer support assistant for Bunoraa, a handcrafted artisan marketplace. Be friendly, helpful, and concise.')),
                ('auto_reply_delay_seconds', models.PositiveIntegerField(default=1)),
                ('max_ai_responses_before_handoff', models.PositiveIntegerField(default=5)),
                ('notify_on_new_chat', models.BooleanField(default=True)),
                ('notify_on_customer_waiting', models.BooleanField(default=True)),
                ('customer_waiting_threshold_minutes', models.PositiveIntegerField(default=2)),
                ('max_concurrent_chats', models.PositiveIntegerField(default=5)),
                ('max_message_length', models.PositiveIntegerField(default=5000)),
                ('max_file_size_mb', models.PositiveIntegerField(default=10)),
                ('allowed_file_types', models.JSONField(default=list, help_text='["image/jpeg", "image/png", "application/pdf"]')),
                ('request_rating', models.BooleanField(default=True)),
                ('rating_prompt', models.CharField(default='How would you rate your experience?', max_length=255)),
                ('support_inbox', models.EmailField(blank=True, default='', max_length=254)),
                ('email_reply_from', models.EmailField(blank=True, default='', max_length=254)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Chat Settings',
                'verbose_name_plural': 'historical Chat Settings',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalConversation',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('status', models.CharField(choices=[('open', 'Open'), ('waiting', 'Waiting for Agent'), ('active', 'Active'), ('on_hold', 'On Hold'), ('resolved', 'Resolved'), ('closed', 'Closed')], db_index=True, default='open', max_length=20)),
                ('category', models.CharField(choices=[('order', 'Order Inquiry'), ('product', 'Product Question'), ('shipping', 'Shipping & Delivery'), ('returns', 'Returns & Refunds'), ('payment', 'Payment Issue'), ('technical', 'Technical Support'), ('general', 'General Inquiry'), ('complaint', 'Complaint'), ('feedback', 'Feedback')], default='general', max_length=20)),
                ('priority', models.PositiveSmallIntegerField(default=3, help_text='1=Urgent, 2=High, 3=Normal, 4=Low')),
                ('subject', models.CharField(blank=True, max_length=255)),
                ('initial_message', models.TextField(blank=True)),
                ('order_reference', models.CharField(blank=True, max_length=50, null=True)),
                ('source', models.CharField(default='website', help_text='website, mobile_app, whatsapp, etc.', max_length=20)),
                ('customer_email', models.EmailField(blank=True, max_length=254)),
                ('customer_name', models.CharField(blank=True, max_length=100)),
                ('customer_phone', models.CharField(blank=True, max_length=20)),
                ('is_bot_handling', models.BooleanField(default=True)),
                ('bot_handoff_requested', models.BooleanField(default=False)),
                ('started_at', models.DateTimeField(blank=True, editable=False)),
                ('first_response_at', models.DateTimeField(blank=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('closed_at', models.DateTimeField(blank=True, null=True)),
                ('last_message_at', models.DateTimeField(blank=True, null=True)),
                ('rating', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('rating_comment', models.TextField(blank=True)),
                ('tags', models.JSONField(default=list)),
                ('internal_notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('agent', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.chatagent')),
                ('customer', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical conversation',
                'verbose_name_plural': 'historical conversations',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalMessage',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('is_from_customer', models.BooleanField(default=True)),
                ('is_from_bot', models.BooleanField(default=False)),
                ('message_type', models.CharField(choices=[('text', 'Text'), ('image', 'Image'), ('file', 'File'), ('system', 'System Message'), ('ai', 'AI Response'), ('canned', 'Canned Response'), ('email', 'Email')], default='text', max_length=20)),
                ('content', models.TextField()),
                ('metadata', models.JSONField(blank=True, default=dict, help_text='Additional data like quick replies, buttons, etc.')),
                ('is_read', models.BooleanField(db_index=True, default=False)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('is_delivered', models.BooleanField(default=True)),
                ('delivered_at', models.DateTimeField(blank=True, null=True)),
                ('is_edited', models.BooleanField(default=False)),
                ('edited_at', models.DateTimeField(blank=True, null=True)),
                ('is_deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('reactions', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('conversation', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.conversation')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('reply_to', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.message')),
                ('sender', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical message',
                'verbose_name_plural': 'historical messages',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalMessageAttachment',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('file', models.TextField(max_length=100)),
                ('file_name', models.CharField(max_length=255)),
                ('file_type', models.CharField(max_length=100)),
                ('file_size', models.PositiveIntegerField()),
                ('thumbnail', models.TextField(blank=True, max_length=100, null=True)),
                ('width', models.PositiveIntegerField(blank=True, null=True)),
                ('height', models.PositiveIntegerField(blank=True, null=True)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('message', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.message')),
            ],
            options={
                'verbose_name': 'historical message attachment',
                'verbose_name_plural': 'historical message attachments',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalTypingIndicator',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('started_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('conversation', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='chat.conversation')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical typing indicator',
                'verbose_name_plural': 'historical typing indicators',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
    ]
